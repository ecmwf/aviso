

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CLI for Notification &mdash; Aviso 0.8.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python API" href="python_api.html" />
    <link rel="prev" title="Triggers" href="triggers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/defining_my_listener.html">Defining my listener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/testing_my_listener.html">Testing my listener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/past_notifications.html">Dealing with past notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/python_api.html">Aviso as a Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/running_service.html">Running as a service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/examples.html">Listener Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="triggers.html">Triggers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CLI for Notification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#listen">Listen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#no-fail">No fail</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#now">Now</a></li>
<li class="toctree-l3"><a class="reference internal" href="#catchup">Catchup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#key">Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="#value">Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notify">Notify</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration_cli.html">CLI for Configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/how_to.html">How to develop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/aviso_client.html">Aviso Client Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/aviso_server.html">Aviso Server Architecture</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Aviso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>CLI for Notification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/reference/notification_cli.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="cli-for-notification">
<h1>CLI for Notification<a class="headerlink" href="#cli-for-notification" title="Permalink to this headline">¶</a></h1>
<p>Aviso provides a Command Line Interface (CLI) for listening to notifications from the server system described in <a class="reference internal" href="../contributing/aviso_server.html#aviso-server"><span class="std std-ref">Aviso Server Architecture</span></a>.
This section describes in details the various commands associated with this functionality.</p>
<div class="section" id="listen">
<span id="notification-cli-listen"></span><h2>Listen<a class="headerlink" href="#listen" title="Permalink to this headline">¶</a></h2>
<p>This command allows to listen to notifications compliant with the listeners defined:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Usage: aviso listen [OPTIONS] [LISTENER_FILES]...</span>

<span class="go">This method allows the user to execute the listeners defined in the YAML</span>
<span class="go">listener file</span>

<span class="go">:param listener_files: YAML file used to define the listeners</span>

<span class="go">Options:</span>
<span class="go">-c, --config TEXT               User configuration file path.</span>
<span class="go">-l, --log TEXT                  Logging configuration file path.</span>
<span class="go">-d, --debug                     Enable the debug log.</span>
<span class="go">-q, --quiet                     Suppress non-error messages from the console output.</span>
<span class="go">--no-fail                       Suppress any error exit code.</span>
<span class="go">-u, --username TEXT             Username required to authenticate to the server.</span>
<span class="go">-k, --key TEXT                  File path to the key required to authenticate to the server.</span>
<span class="go">-H, --host TEXT                 Notification server host.</span>
<span class="go">-P, --port INTEGER              Notification server port.</span>
<span class="go">--test                          Activate TestMode.</span>
<span class="go">--from [%Y-%m-%dT%H:%M:%S.%fZ]  Replay notification from this date.</span>
<span class="go">--to [%Y-%m-%dT%H:%M:%S.%fZ]    Replay notification to this date.</span>
<span class="go">--now                           Ignore missed notifications, only listen to new ones.</span>
<span class="go">--catchup                       Retrieve first the missed notifications.</span>
<span class="go">-h, --help                      Show this message and exit.</span>
</pre></div>
</div>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">listener_files</span></code> is used to define the event listeners and the triggers to execute in case
of notifications. If not present the system will look for the default listeners which can be
defined in the configuration files. Here an example of invoking this command with one listener file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">%</span> aviso listen examples/echoListener.yaml
</pre></div>
</div>
<p>Once in execution this command will create a background process waiting for notifications and a foreground process in busy
waiting mode. Multiple files can also be indicated as  shown below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">%</span> aviso listen listener1.yaml listener2.yaml
</pre></div>
</div>
<p>Most of the options accepted by this command are used to change the application configuration. Below are presented only the options
that are not covered by the <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration</span></a> section.</p>
<div class="section" id="no-fail">
<h3>No fail<a class="headerlink" href="#no-fail" title="Permalink to this headline">¶</a></h3>
<p>If the option <code class="docutils literal notranslate"><span class="pre">--no-fail</span></code> is present the application will always exit with error code 0, even in case of errors. This can be
useful when used in a automated workflow that is required not to stop even if Aviso exit because of errors.</p>
</div>
<div class="section" id="test">
<h3>Test<a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h3>
<p>If the option <code class="docutils literal notranslate"><span class="pre">--test</span></code> is present the application will run in <cite>TestMode</cite>. See <a class="reference internal" href="../guide/testing_my_listener.html#testing-my-listener"><span class="std std-ref">Testing my listener</span></a> for more information.</p>
</div>
<div class="section" id="now">
<h3>Now<a class="headerlink" href="#now" title="Permalink to this headline">¶</a></h3>
<p>If the option <code class="docutils literal notranslate"><span class="pre">--now</span></code> is present the application will start ignoring the missed notifications while listening only to the new ones. See <a class="reference internal" href="../guide/past_notifications.html#past-notifications"><span class="std std-ref">Dealing with past notifications</span></a> for more information.</p>
</div>
<div class="section" id="catchup">
<h3>Catchup<a class="headerlink" href="#catchup" title="Permalink to this headline">¶</a></h3>
<p>If the option <code class="docutils literal notranslate"><span class="pre">--catchup</span></code> is present the application will start retrieving first the missed notifications and then listening to the new ones. See <a class="reference internal" href="../guide/past_notifications.html#past-notifications"><span class="std std-ref">Dealing with past notifications</span></a> for more information.
This option is enabled by default. See <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration</span></a> for more information.</p>
</div>
</div>
<div class="section" id="key">
<h2>Key<a class="headerlink" href="#key" title="Permalink to this headline">¶</a></h2>
<p>This command can be used to generate the key accepted by the notification server as part of the notification key-value
pair. This command is mostly used for debugging.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Usage: aviso key [OPTIONS] PARAMETERS</span>

<span class="go">Generate the key to send to the notification server according to the</span>
<span class="go">current schema using the parameters defined</span>

<span class="go">:param parameters: key1=value1,key2=value2,...</span>

<span class="go">Options:</span>
<span class="go">-c, --config TEXT    User configuration file path.</span>
<span class="go">-l, --log TEXT       Logging configuration file path.</span>
<span class="go">-d, --debug          Enable the debug log.</span>
<span class="go">-q, --quiet          Suppress non-error messages from the console output.</span>
<span class="go">--no-fail            Suppress any error exit code.</span>
<span class="go">-u, --username TEXT  Username required to authenticate to the server.</span>
<span class="go">-k, --key TEXT       File path to the key required to authenticate to the</span>
<span class="go">                    server.</span>
<span class="go">-H, --host TEXT      Notification server host.</span>
<span class="go">-P, --port INTEGER   Notification server port.</span>
<span class="go">--test               Activate TestMode.</span>
<span class="go">-h, --help           Show this message and exit.</span>
</pre></div>
</div>
<p>Here an example of this command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">%</span> aviso key <span class="nv">event</span><span class="o">=</span>dissemination,target<span class="o">=</span>E1,class<span class="o">=</span>od,date<span class="o">=</span><span class="m">20190810</span>,destination<span class="o">=</span>FOO,domain<span class="o">=</span>g,expver<span class="o">=</span><span class="m">1</span>,step<span class="o">=</span><span class="m">1</span>,stream<span class="o">=</span>enfo,time<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>Note the various parameters required by the notification. The output from this command will be something like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/ec/diss/FOO/target=E1,class=od,expver=0001,domain=g,date=20190810,time=00,stream=enfo,step=001</span>
</pre></div>
</div>
<p>Note how the format and the order of the parameters have been adjusted to complying with the internal key schema.</p>
<p>All the options accepted by this command are covered in <a class="reference internal" href="#notification-cli-listen"><span class="std std-ref">Listen</span></a> and in <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration</span></a>.</p>
</div>
<div class="section" id="value">
<h2>Value<a class="headerlink" href="#value" title="Permalink to this headline">¶</a></h2>
<p>This command is used to retrieve from the server the value associated to a set of key-value pairs using the same syntax
of the command <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Usage: aviso value [OPTIONS] PARAMETERS</span>

<span class="go">Return the value on the server corresponding to the key which is generated</span>
<span class="go">according to the current schema and the parameters defined</span>

<span class="go">:param parameters: key1=value1,key2=value2,...</span>

<span class="go">Options:</span>
<span class="go">-c, --config TEXT    User configuration file path.</span>
<span class="go">-l, --log TEXT       Logging configuration file path.</span>
<span class="go">-d, --debug          Enable the debug log.</span>
<span class="go">-q, --quiet          Suppress non-error messages from the console output.</span>
<span class="go">--no-fail            Suppress any error exit code.</span>
<span class="go">-u, --username TEXT  Username required to authenticate to the server.</span>
<span class="go">-k, --key TEXT       File path to the key required to authenticate to the</span>
<span class="go">                    server.</span>
<span class="go">-H, --host TEXT      Notification server host.</span>
<span class="go">-P, --port INTEGER   Notification server port.</span>
<span class="go">--test               Activate TestMode.</span>
<span class="go">-h, --help           Show this message and exit.</span>
</pre></div>
</div>
<p>Here an example of this command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">%</span> aviso value <span class="nv">event</span><span class="o">=</span>dissemination,target<span class="o">=</span>E1,class<span class="o">=</span>od,date<span class="o">=</span><span class="m">20190810</span>,destination<span class="o">=</span>FOO,domain<span class="o">=</span>g,expver<span class="o">=</span><span class="m">1</span>,step<span class="o">=</span><span class="m">1</span>,stream<span class="o">=</span>enfo,time<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>Note the list of parameters required, it is the same list required by the <code class="docutils literal notranslate"><span class="pre">key</span></code> command.</p>
<p>All the options accepted by this command are covered in <a class="reference internal" href="#notification-cli-listen"><span class="std std-ref">Listen</span></a> and in <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration</span></a>.</p>
</div>
<div class="section" id="notify">
<h2>Notify<a class="headerlink" href="#notify" title="Permalink to this headline">¶</a></h2>
<p>This command is used to directly send a notification to the server using the same syntax of the command <code class="docutils literal notranslate"><span class="pre">key</span></code></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Usage: aviso notify [OPTIONS] PARAMETERS</span>

<span class="go">Create a notification with the parameters passed and submit it to the</span>
<span class="go">notification server :param parameters: key1=value1,key2=value2,...</span>

<span class="go">Options:</span>
<span class="go">-c, --config TEXT    User configuration file path.</span>
<span class="go">-l, --log TEXT       Logging configuration file path.</span>
<span class="go">-d, --debug          Enable the debug log.</span>
<span class="go">-q, --quiet          Suppress non-error messages from the console output.</span>
<span class="go">--no-fail            Suppress any error exit code.</span>
<span class="go">-u, --username TEXT  Username required to authenticate to the server.</span>
<span class="go">-k, --key TEXT       File path to the key required to authenticate to the</span>
<span class="go">                    server.</span>
<span class="go">-H, --host TEXT      Notification server host.</span>
<span class="go">-P, --port INTEGER   Notification server port.</span>
<span class="go">--test               Activate TestMode.</span>
<span class="go">-h, --help           Show this message and exit.</span>
</pre></div>
</div>
<p>Here an example of this command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">%</span> aviso notify <span class="nv">event</span><span class="o">=</span>dissemination,target<span class="o">=</span>E1,class<span class="o">=</span>od,date<span class="o">=</span><span class="m">20190810</span>,destination<span class="o">=</span>FOO,domain<span class="o">=</span>g,expver<span class="o">=</span><span class="m">1</span>,step<span class="o">=</span><span class="m">1</span>,stream<span class="o">=</span>enfo,time<span class="o">=</span><span class="m">0</span>,location<span class="o">=</span>xxxxxxxx
</pre></div>
</div>
<p>Note the list of parameters required, it is the same list required by the <code class="docutils literal notranslate"><span class="pre">key</span></code> command with the addition of the <code class="docutils literal notranslate"><span class="pre">location</span></code>
pair. This is needed only for the <code class="docutils literal notranslate"><span class="pre">dissemination</span></code> event.</p>
<p>In the case of a <code class="docutils literal notranslate"><span class="pre">mars</span></code> event the command looks like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">%</span> aviso notify <span class="nv">event</span><span class="o">=</span>mars,class<span class="o">=</span>od,date<span class="o">=</span><span class="m">20190810</span>,domain<span class="o">=</span>g,expver<span class="o">=</span><span class="m">1</span>,step<span class="o">=</span><span class="m">1</span>,stream<span class="o">=</span>enfo,time<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>with no <code class="docutils literal notranslate"><span class="pre">destination</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code> and <code class="docutils literal notranslate"><span class="pre">location</span></code> pair.</p>
<p>All the options accepted by this command are covered in <a class="reference internal" href="#notification-cli-listen"><span class="std std-ref">Listen</span></a> and in <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="python_api.html" class="btn btn-neutral float-right" title="Python API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="triggers.html" class="btn btn-neutral float-left" title="Triggers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, ECMWF

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>