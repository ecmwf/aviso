

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Defining my listener &mdash; Aviso 0.8.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/defining_my_listener.html">Defining my listener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/testing_my_listener.html">Testing my listener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/historical_notifications.html">Dealing with historical notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/python_api.html">Aviso as a Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/running_service.html">Running as a service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/examples.html">Listener Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="triggers.html">Triggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="notification_cli.html">CLI for Notification System</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/how_to.html">How to develop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/aviso_client.html">Aviso Client Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/aviso_server.html">Aviso Server Architecture</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Aviso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Defining my listener</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/reference/defining_my_listener.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="defining-my-listener">
<span id="id1"></span><h1>Defining my listener<a class="headerlink" href="#defining-my-listener" title="Permalink to this headline">¶</a></h1>
<p>Aviso configuration file allows the definition of multiple listeners. Alternatively, the listeners configuration can be indicated as an independent file or multiple files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">%</span> aviso listen listener1.yaml listener2.yaml
</pre></div>
</div>
<p>Regardless where is defined, each listener is composed of:</p>
<ul class="simple">
<li><p>an <code class="docutils literal notranslate"><span class="pre">event</span></code> type</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">request</span></code> block</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">triggers</span></code> block</p></li>
</ul>
<dl>
<dt>Here a basic example:</dt><dd><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">listeners</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">event</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mars</span>
   <span class="nt">request</span><span class="p">:</span>
      <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">od</span>
      <span class="nt">expver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">domain</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">g</span>
      <span class="nt">stream</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">enfo</span>
      <span class="nt">step</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="nv">3</span><span class="p p-Indicator">]</span>
   <span class="nt">triggers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo</span>
</pre></div>
</div>
</dd>
</dl>
<div class="section" id="event">
<h2>Event<a class="headerlink" href="#event" title="Permalink to this headline">¶</a></h2>
<p>Aviso offers notifications for the following types of events:</p>
<ul class="simple">
<li><p><strong>dissemination</strong> event is submitted by the product dissemination system ECPDS. The related listener configuration must define the <code class="docutils literal notranslate"><span class="pre">destination</span></code> field. A notification related to a dissemination event will have the field <code class="docutils literal notranslate"><span class="pre">location</span></code> containing the URL to the product notified</p></li>
<li><p><strong>mars</strong> event is designed for real-time data from the ECMWF model output. The related listener configuration does not have any mandatory fields. Moreover the related notification will not contain the location field because users will have to access to it by the conventional MARS API</p></li>
</ul>
</div>
<div class="section" id="request">
<h2>Request<a class="headerlink" href="#request" title="Permalink to this headline">¶</a></h2>
<p>The table below shows the full list of fields accepted in a <code class="docutils literal notranslate"><span class="pre">request</span></code> block. These fields represent a subset on the MARS language.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 32%" />
<col style="width: 21%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Event</p></th>
<th class="head"><p>Optional/Mandatory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>destination</p></td>
<td><p>String, uppercase</p></td>
<td><p>dissemination</p></td>
<td><p>Mandatory</p></td>
</tr>
<tr class="row-odd"><td><p>target</p></td>
<td><p>String</p></td>
<td><p>dissemination</p></td>
<td><p>Optional</p></td>
</tr>
<tr class="row-even"><td><p>date</p></td>
<td><p>Date (e.g.20190810)</p></td>
<td><p>All</p></td>
<td><p>Optional</p></td>
</tr>
<tr class="row-odd"><td><p>time</p></td>
<td><p>Values: [0,6,12,18]</p></td>
<td><p>All</p></td>
<td><p>Optional</p></td>
</tr>
<tr class="row-even"><td><p>class</p></td>
<td><p>Enum</p></td>
<td><p>All</p></td>
<td><p>Optional</p></td>
</tr>
<tr class="row-odd"><td><p>stream</p></td>
<td><p>Enum</p></td>
<td><p>All</p></td>
<td><p>Optional</p></td>
</tr>
<tr class="row-even"><td><p>domain</p></td>
<td><p>Enum</p></td>
<td><p>All</p></td>
<td><p>Optional</p></td>
</tr>
<tr class="row-odd"><td><p>expver</p></td>
<td><p>Integer</p></td>
<td><p>All</p></td>
<td><p>Optional</p></td>
</tr>
<tr class="row-even"><td><p>step</p></td>
<td><p>Integer</p></td>
<td><p>All</p></td>
<td><p>Optional</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="triggers">
<h2>Triggers<a class="headerlink" href="#triggers" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">triggers</span></code> block accepts a sequence of triggers. Each trigger will result in an independent process executed every time a notification is received.
These are the triggers currently available:</p>
<ul class="simple">
<li><p><strong>echo</strong> is the simplest trigger as it prints the notification to the console output. It is used for testing</p></li>
<li><p><strong>log</strong> is useful for recording the received event to a log file</p></li>
<li><p><strong>command</strong> allows the user to define a shell command to work with the notification</p></li>
<li><p><strong>post</strong> allows the user to send the notification received as HTTP POST message formatted accordingly to the <a class="reference external" href="https://cloudevents.io/">CloudEvent</a> specification</p></li>
</ul>
<p>More information are available in the <a class="reference internal" href="triggers.html#triggers"><span class="std std-ref">Triggers</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, ECMWF

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>